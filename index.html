<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><title>GO TO NEW WORLD</title><meta name="author" content="Mr.GaO"><meta name="copyright" content="Mr.GaO"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta property="og:type" content="website">
<meta property="og:title" content="GO TO NEW WORLD">
<meta property="og:url" content="https://www.1year1x.com/index.html">
<meta property="og:site_name" content="GO TO NEW WORLD">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://www.1year1x.com/img/avatar.jpg">
<meta property="article:author" content="Mr.GaO">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://www.1year1x.com/img/avatar.jpg"><link rel="shortcut icon" href="/img/favicon_diy1.ico"><link rel="canonical" href="https://www.1year1x.com/"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//hm.baidu.com"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css" media="print" onload="this.media='all'"><script>var _hmt = _hmt || [];
(function() {
  var hm = document.createElement("script");
  hm.src = "https://hm.baidu.com/hm.js?ea4aaa0a9d7561bf3699a38257cd1d4e";
  var s = document.getElementsByTagName("script")[0]; 
  s.parentNode.insertBefore(hm, s);
})();
</script><script>const GLOBAL_CONFIG = { 
  root: '/',
  algolia: undefined,
  localSearch: {"path":"search.xml","languages":{"hits_empty":"找不到您查询的内容：${query}"}},
  translate: undefined,
  noticeOutdate: undefined,
  highlight: {"plugin":"highlighjs","highlightCopy":true,"highlightLang":true},
  copy: {
    success: '复制成功',
    error: '复制错误',
    noSupport: '浏览器不支持'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: '',
  date_suffix: {
    just: '刚刚',
    min: '分钟前',
    hour: '小时前',
    day: '天前',
    month: '个月前'
  },
  copyright: undefined,
  lightbox: 'fancybox',
  Snackbar: undefined,
  source: {
    jQuery: 'https://cdn.jsdelivr.net/npm/jquery@latest/dist/jquery.min.js',
    justifiedGallery: {
      js: 'https://cdn.jsdelivr.net/npm/justifiedGallery/dist/js/jquery.justifiedGallery.min.js',
      css: 'https://cdn.jsdelivr.net/npm/justifiedGallery/dist/css/justifiedGallery.min.css'
    },
    fancybox: {
      js: 'https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.js',
      css: 'https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.css'
    }
  },
  isPhotoFigcaption: true,
  islazyload: false,
  isanchor: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = { 
  isPost: false,
  isHome: true,
  isHighlightShrink: false,
  isToc: false,
  postUpdate: '2024-06-27 18:15:10'
}</script><noscript><style type="text/css">
  #nav {
    opacity: 1
  }
  .justified-gallery img {
    opacity: 1
  }

  #recent-posts time,
  #post-meta time {
    display: inline !important
  }
</style></noscript><script>(win=>{
    win.saveToLocal = {
      set: function setWithExpiry(key, value, ttl) {
        if (ttl === 0) return
        const now = new Date()
        const expiryDay = ttl * 86400000
        const item = {
          value: value,
          expiry: now.getTime() + expiryDay,
        }
        localStorage.setItem(key, JSON.stringify(item))
      },

      get: function getWithExpiry(key) {
        const itemStr = localStorage.getItem(key)

        if (!itemStr) {
          return undefined
        }
        const item = JSON.parse(itemStr)
        const now = new Date()

        if (now.getTime() > item.expiry) {
          localStorage.removeItem(key)
          return undefined
        }
        return item.value
      }
    }
  
    win.getScript = url => new Promise((resolve, reject) => {
      const script = document.createElement('script')
      script.src = url
      script.async = true
      script.onerror = reject
      script.onload = script.onreadystatechange = function() {
        const loadState = this.readyState
        if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
        script.onload = script.onreadystatechange = null
        resolve()
      }
      document.head.appendChild(script)
    })
  
      win.activateDarkMode = function () {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      win.activateLightMode = function () {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }
      const t = saveToLocal.get('theme')
    
          if (t === 'dark') activateDarkMode()
          else if (t === 'light') activateLightMode()
        
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        if (asideStatus === 'hide') {
          document.documentElement.classList.add('hide-aside')
        } else {
          document.documentElement.classList.remove('hide-aside')
        }
      }
    })(window)</script><link rel="stylesheet" href="/css/mycss.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/aplayer/dist/APlayer.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/aplayer/dist/APlayer.min.js"></script><script src="https://cdn.jsdelivr.net/gh/metowolf/MetingJS@1.2/dist/Meting.min.js"></script><link rel="stylesheet" href="APlayer.min.css"><div id="aplayer"></div><script src="https://cdn.jsdelivr.net/gh/radium-bit/res@master/live2d/autoload.js" async></script><script src="https://cdn.jsdelivr.net/npm/meting@2/dist/Meting.min.js" async></script><meta name="generator" content="Hexo 5.3.0"><link rel="stylesheet" href="\css\APlayer.min.css" class="aplayer-style-marker">
<script src="\js\APlayer.min.js" class="aplayer-script-marker"></script>
<script src="\js\Meting.min.js" class="meting-script-marker"></script>
</head><body><div id="loading-box"><div class="loading-left-bg"></div><div class="loading-right-bg"></div><div class="spinner-box"><div class="configure-border-1"><div class="configure-core"></div></div><div class="configure-border-2"><div class="configure-core"></div></div><div class="loading-word">加载中...</div></div></div><div id="web_bg"></div><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="author-avatar"><img class="avatar-img" src="/img/avatar.jpg" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"/></div><div class="site-data"><div class="data-item is-center"><div class="data-item-link"><a href="/archives/"><div class="headline">文章</div><div class="length-num">66</div></a></div></div><div class="data-item is-center"><div class="data-item-link"><a href="/tags/"><div class="headline">标签</div><div class="length-num">27</div></a></div></div><div class="data-item is-center"><div class="data-item-link"><a href="/categories/"><div class="headline">分类</div><div class="length-num">8</div></a></div></div></div><hr/><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 時間軸</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span></a></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><i class="fa-fw fas fa-list"></i><span> List</span><i class="fas fa-chevron-down expand"></i></a><ul class="menus_item_child"><li><a class="site-page" href="/music/"><i class="fa-fw fas fa-music"></i><span> Music</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> 友链</span></a></div></div></div></div><div class="page" id="body-wrap"><header class="full_page" id="page-header" style="background-image: url('/img/index/index2.jpg')"><nav id="nav"><span id="blog_name"><a id="site-name" href="/">GO TO NEW WORLD</a></span><div id="menus"><div id="search-button"><a class="site-page social-icon search"><i class="fas fa-search fa-fw"></i><span> 搜索</span></a></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 時間軸</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span></a></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><i class="fa-fw fas fa-list"></i><span> List</span><i class="fas fa-chevron-down expand"></i></a><ul class="menus_item_child"><li><a class="site-page" href="/music/"><i class="fa-fw fas fa-music"></i><span> Music</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> 友链</span></a></div></div><div id="toggle-menu"><a class="site-page"><i class="fas fa-bars fa-fw"></i></a></div></div></nav><div id="site-info"><h1 id="site-title">GO TO NEW WORLD</h1><div id="site-subtitle"><span id="subtitle"></span></div><div id="site_social_icons"><a class="social-icon" href="mailto:xldsmile@163.com" target="_blank" title="Email"><i class="fas fa-envelope"></i></a></div></div><div id="scroll-down"><i class="fas fa-angle-down scroll-down-effects"></i></div></header><main class="layout" id="content-inner"><div class="recent-posts" id="recent-posts"><div class="recent-post-item"><div class="post_cover left_radius"><a href="/2021/07/10/ansible_win_spooler_fix/" title="Windows打印机漏洞修复">     <img class="post_bg" src="/img/cover/goland.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="Windows打印机漏洞修复"></a></div><div class="recent-post-info"><a class="article-title" href="/2021/07/10/ansible_win_spooler_fix/" title="Windows打印机漏洞修复">Windows打印机漏洞修复</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">发表于</span><time datetime="2021-07-10T13:11:10.000Z" title="发表于 2021-07-10 21:11:10">2021-07-10</time></span><span class="article-meta"><span class="article-meta__separator">|</span><i class="fas fa-inbox"></i><a class="article-meta__categories" href="/categories/Security/">Security</a></span><span class="article-meta tags"><span class="article-meta__separator">|</span><i class="fas fa-tag"></i><a class="article-meta__tags" href="/tags/%E5%AE%9E%E8%B7%B5%E6%80%BB%E7%BB%93/">实践总结</a><span class="article-meta__link">•</span><a class="article-meta__tags" href="/tags/baseline/">baseline</a><span class="article-meta__link">•</span><a class="article-meta__tags" href="/tags/CVE/">CVE</a></span></div><div class="content">
知识文档：


CVE-2021-34527



漏洞风险描述：Windows 打印后台处理程序远程代码执行漏洞 (CVE-2021-34527)
当 Windows 打印后台处理程序服务不正确地执行特权文件操作时，存在远程执行代码漏洞。成功利用此漏洞的攻击者可以使用系统特权运行任意代码。攻击者可随后安装程序；查看、更改或删除数据；或者创建拥有完全用户权限的新帐户。
解决方法Powershell运行PowerShell：Win+X，选择以管理员身份运行命令行或 Windows Terminal；确定打印后台处理程序服务是否正在运行：
1Get-Service -Name Spooler
关闭并禁用打印后台处理程序服务：
12Stop-Service -Name Spooler -ForceSet-Service -Name Spooler -StartupType Disabled

注意：禁用打印后台处理程序服务会禁用本地和远程打印功能

手动关闭
ansible role远程关闭
Windows端需要提前进行环境配置，文档请参考ansible 远程Windows主机；

配置i ...</div></div></div><div class="recent-post-item"><div class="post_cover right_radius"><a href="/2020/09/05/aws_s3_introduction/" title="AWS S3 Bucket 简介">     <img class="post_bg" src="/img/cover/aws.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="AWS S3 Bucket 简介"></a></div><div class="recent-post-info"><a class="article-title" href="/2020/09/05/aws_s3_introduction/" title="AWS S3 Bucket 简介">AWS S3 Bucket 简介</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">发表于</span><time datetime="2020-09-04T22:30:16.000Z" title="发表于 2020-09-05 06:30:16">2020-09-05</time></span><span class="article-meta"><span class="article-meta__separator">|</span><i class="fas fa-inbox"></i><a class="article-meta__categories" href="/categories/AWS/">AWS</a></span><span class="article-meta tags"><span class="article-meta__separator">|</span><i class="fas fa-tag"></i><a class="article-meta__tags" href="/tags/S3/">S3</a></span></div><div class="content">
知识文档：


产品介绍
DOSC


对象存储 Amazon S3Amazon Simple Storage Service (Amazon S3) 是一种对象存储服务，提供行业领先的可扩展性、数据可用性、安全性和性能。Amazon S3 可达到 99.999999999%（11 个 9）的持久性，并为全球各地的公司存储数百万个应用程序的数据。
使用 Amazon S3 的优势Amazon S3 特意内置了着重于简易性和稳健性的最小功能集。以下是使用 Amazon S3 的一些优势：

创建存储桶 – 创建和命名存储数据的存储桶。存储桶是 Amazon S3 中用于数据存储的基础容器。
存储数据 – 在存储桶中存储无限量的数据。可将所需数量的对象上传到 Amazon S3 存储桶。每个对象可包含最多 5 TB 的数据。使用开发人员分配的唯一键值存储和检索每个对象。
下载数据 – 下载您的数据或允许其他人进行下载。随时下载您的数据或允许其他人进行下载。
权限 – 对于要在您的 Amazon S3 存储桶中上传或下载数据的其他人员，您可以授予其访问权限或拒绝其访问。将上传和下载的许可授 ...</div></div></div><div class="recent-post-item"><div class="post_cover left_radius"><a href="/2020/09/05/aws_s3cmd/" title="s3cmd—AWS S3存储桶管理工具">     <img class="post_bg" src="/img/cover/aws.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="s3cmd—AWS S3存储桶管理工具"></a></div><div class="recent-post-info"><a class="article-title" href="/2020/09/05/aws_s3cmd/" title="s3cmd—AWS S3存储桶管理工具">s3cmd—AWS S3存储桶管理工具</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">发表于</span><time datetime="2020-09-04T22:30:16.000Z" title="发表于 2020-09-05 06:30:16">2020-09-05</time></span><span class="article-meta"><span class="article-meta__separator">|</span><i class="fas fa-inbox"></i><a class="article-meta__categories" href="/categories/AWS/">AWS</a></span><span class="article-meta tags"><span class="article-meta__separator">|</span><i class="fas fa-tag"></i><a class="article-meta__tags" href="/tags/S3/">S3</a></span></div><div class="content">s3cmd 是用于创建S3桶，上传，检索和管理数据到对象存储命令行实用程序。 本文将指导linux下安装s3cmd程序，以及对象存储服务桶和对象数据管理，包括创建桶、上传、检索、删除及本地与对象存储服务间数据同步等。本文以下内容将以CentOS 7.3的弹性云服务器为例，windows操作系统使用类似。
1. 安装s3cmd1$ yum -y install s3cmd

2. 配置s3cmd执行 $ s3cmd --configure生成配置文件，一路Enter，注意跳过认证并保存配置
123456.........Test access with supplied credentials? [Y&#x2F;n] nSave settings? [y&#x2F;N] yConfiguration saved to &#39;&#x2F;root&#x2F;.s3cfg&#39;
修改一下几项：
123456$ vim &#x2F;root&#x2F;.s3cfgaccess_key &#x3D; xxxsecret_key &#x3D; xxxhost_base &#x3D; ip: ...</div></div></div><div class="recent-post-item"><div class="post_cover right_radius"><a href="/2020/09/03/aws_elb_listener/" title="AWS 侦听器配置管理">     <img class="post_bg" src="/img/cover/aws.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="AWS 侦听器配置管理"></a></div><div class="recent-post-info"><a class="article-title" href="/2020/09/03/aws_elb_listener/" title="AWS 侦听器配置管理">AWS 侦听器配置管理</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">发表于</span><time datetime="2020-09-02T22:30:16.000Z" title="发表于 2020-09-03 06:30:16">2020-09-03</time></span><span class="article-meta"><span class="article-meta__separator">|</span><i class="fas fa-inbox"></i><a class="article-meta__categories" href="/categories/AWS/">AWS</a></span><span class="article-meta tags"><span class="article-meta__separator">|</span><i class="fas fa-tag"></i><a class="article-meta__tags" href="/tags/ELB/">ELB</a></span></div><div class="content">
知识文档：


ALB侦听器
ELB disable TLSv1.0

Application Load Balancer 的侦听器在开始使用 应用程序负载均衡器 之前，您必须添加一个或多个侦听器。侦听器是一个使用您配置的协议和端口检查连接请求的进程。您为侦听器定义的规则确定负载均衡器如何将请求路由到其已注册目标。
更新HTTPS侦听器更新安全策略：ELB disable TLSv1.0
在创建 HTTPS 侦听器时，您可以选择满足您的需求的安全策略。添加新的安全策略后，您可以将 HTTPS 侦听器更新为使用此新安全策略。Application Load Balancer 不支持自定义安全策略。
使用控制台更新安全策略：

打开 Amazon EC2 控制台 https://console.aws.amazon.com/ec2/
在导航窗格上的 LOAD BALANCING 下，选择 Load Balancers。
选择负载均衡器，然后选择 Listeners。
选中 HTTPS 侦听器对应的复选框，然后选择 Edit (编辑)。
对于 Security policy (安全策略)， ...</div></div></div><div class="recent-post-item"><div class="post_cover left_radius"><a href="/2020/09/03/aws_elb_use/" title="AWS应用程序负载均衡的使用">     <img class="post_bg" src="/img/cover/aws.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="AWS应用程序负载均衡的使用"></a></div><div class="recent-post-info"><a class="article-title" href="/2020/09/03/aws_elb_use/" title="AWS应用程序负载均衡的使用">AWS应用程序负载均衡的使用</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">发表于</span><time datetime="2020-09-02T22:30:16.000Z" title="发表于 2020-09-03 06:30:16">2020-09-03</time></span><span class="article-meta"><span class="article-meta__separator">|</span><i class="fas fa-inbox"></i><a class="article-meta__categories" href="/categories/AWS/">AWS</a></span><span class="article-meta tags"><span class="article-meta__separator">|</span><i class="fas fa-tag"></i><a class="article-meta__tags" href="/tags/ELB/">ELB</a></span></div><div class="content">配置负载均衡器名称：就是ELB的标识名称模式：如果是需要对外Internet访问就选择面向internet；如果是内网服务使用，就选择内部侦听器：就是填写监听的端口，端口号，自定义
可用区：（这个比较重要）你后端的那些机器在那个VPC、子网、可用区内，这里你就选哪个。例如，我的两台web在默认VPC内的，az-1a和az-1d内，所以我在ALB选择可用区的话，就选择az-1a和az-1d

查看后端实例所在的可用区


ALB设置可用区
配置安全组此安全组跟实例的安全组不是一个。详情区分请看，如何理解使用安全组和NACL

配置路由目标组：就是后端使用机器的群组，新建或者选择现有的名称：标记性名称协议：就是ALB到后端服务器之前的协议。端口：这个是后端服务的端口。如果是访问NLB的80端口转到后端机器8080的端口。这里就要填8080了。80—》8080目录类型：这里要选择instance（实例类型）

注册目标这里选择的要注意：

1、在下方选择相应的实例，记住你这里的机器所处的可用区必须要和前面选的可用区是一样的，要不无法使用
2、选择好实例后，记住！一定要点击添加到已注册！！如果 ...</div></div></div><div class="recent-post-item"><div class="post_cover right_radius"><a href="/2020/09/02/aws_ec2_monitor-disk_memory/" title="自定义监控 EC2 内存和磁盘使用率">     <img class="post_bg" src="/img/cover/aws.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="自定义监控 EC2 内存和磁盘使用率"></a></div><div class="recent-post-info"><a class="article-title" href="/2020/09/02/aws_ec2_monitor-disk_memory/" title="自定义监控 EC2 内存和磁盘使用率">自定义监控 EC2 内存和磁盘使用率</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">发表于</span><time datetime="2020-09-01T22:30:16.000Z" title="发表于 2020-09-02 06:30:16">2020-09-02</time></span><span class="article-meta"><span class="article-meta__separator">|</span><i class="fas fa-inbox"></i><a class="article-meta__categories" href="/categories/AWS/">AWS</a></span><span class="article-meta tags"><span class="article-meta__separator">|</span><i class="fas fa-tag"></i><a class="article-meta__tags" href="/tags/EC2/">EC2</a><span class="article-meta__link">•</span><a class="article-meta__tags" href="/tags/CloudWatch/">CloudWatch</a></span></div><div class="content">
知识文档：


监控EC2内存和磁盘使用率
设置SNS通知


AWS提供的CloudWatch中，没有提供内存使用率和磁盘使用率的信息，因此需要手动添加cron不过，AWS提供了官方的脚本，可以直接下载安装；环境以Amazon Linux 2 或 Amazon Linux AMI 为例
Role权限首先确保用户权限中有操作权限，没有的话，用户界面添加：

cloudwatch:PutMetricData
cloudwatch:GetMetricStatistics
cloudwatch:ListMetrics
ec2:DescribeTags

依赖包的安装1sudo yum install -y perl-Switch perl-DateTime perl-Sys-Syslog perl-LWP-Protocol-https perl-Digest-SHA.x86_64
安装监控脚本下载、安装和配置监控脚本：
1curl https:&#x2F;&#x2F;aws-cloudwatch.s3.amazonaws.com&#x2F;downloads&#x2F;CloudWatch ...</div></div></div><div class="recent-post-item"><div class="post_cover left_radius"><a href="/2020/09/02/aws_elb_introduction/" title="AWS ELB介绍">     <img class="post_bg" src="/img/cover/aws.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="AWS ELB介绍"></a></div><div class="recent-post-info"><a class="article-title" href="/2020/09/02/aws_elb_introduction/" title="AWS ELB介绍">AWS ELB介绍</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">发表于</span><time datetime="2020-09-01T22:30:16.000Z" title="发表于 2020-09-02 06:30:16">2020-09-02</time></span><span class="article-meta"><span class="article-meta__separator">|</span><i class="fas fa-inbox"></i><a class="article-meta__categories" href="/categories/AWS/">AWS</a></span><span class="article-meta tags"><span class="article-meta__separator">|</span><i class="fas fa-tag"></i><a class="article-meta__tags" href="/tags/ELB/">ELB</a></span></div><div class="content">
知识文档：


Elastic Load Balancing 概况
Elastic Load Balancing 文档

概况Elastic Load Balancing 在多个目标（如 Amazon EC2 实例、容器、IP 地址和 Lambda 函数）之间自动分配传入的应用程序流量。它可以在单个可用区内处理不断变化的应用程序流量负载，也可以跨多个可用区处理此类负载。
Elastic Load Balancing 支持三种类型的负载均衡器：

Application Load Balancer（7层应用程序负载均衡器）
Network Load Balancer （4层网络负载均衡器）
Classic Load Balancer（传统负载均衡器）#这个使用很少了

可以根据应用程序需求选择不同类型的负载均衡器

底层实现原理
1、ELB由负载均衡器和目标组组成
2、⭐️A、B为两个安全组。
3、负载均衡器里面的实例地址IP也占用VPC子网的IP，并且负载均衡器里面的实例可以自动伸缩；负载均衡器内的实例对用户不可见；
4、VPC子网划分，IP使用数量，也要考虑elb的自动伸缩的场景； ...</div></div></div><div class="recent-post-item"><div class="post_cover right_radius"><a href="/2020/09/01/aws_ec2_monitor_ideas/" title="EC2监控最佳实践">     <img class="post_bg" src="/img/cover/aws.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="EC2监控最佳实践"></a></div><div class="recent-post-info"><a class="article-title" href="/2020/09/01/aws_ec2_monitor_ideas/" title="EC2监控最佳实践">EC2监控最佳实践</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">发表于</span><time datetime="2020-08-31T22:30:16.000Z" title="发表于 2020-09-01 06:30:16">2020-09-01</time></span><span class="article-meta"><span class="article-meta__separator">|</span><i class="fas fa-inbox"></i><a class="article-meta__categories" href="/categories/AWS/">AWS</a></span><span class="article-meta tags"><span class="article-meta__separator">|</span><i class="fas fa-tag"></i><a class="article-meta__tags" href="/tags/EC2/">EC2</a><span class="article-meta__link">•</span><a class="article-meta__tags" href="/tags/CloudWatch/">CloudWatch</a></span></div><div class="content">EC2监控最佳实践使用以下监控最佳实践，帮助您执行 Amazon EC2 监控任务。

让监控成为优先事务，阻止小问题演变为大问题。
创建并实施从 AWS 解决方案各个部分收集监控数据的监控计划，以便更轻松地调试发生的多点故障。您的监控计划至少应该解决以下问题：
您的监控目标是什么？
您将监控哪些资源？
监控这些资源的频率如何？
您将使用哪些监控工具？
谁负责执行监控任务？
出现错误时应通知谁？


尽可能自动监控任务。
检查 EC2 实例的日志文件。


使用 EC2 控制台创建警报
知识文档：


为实例创建 CloudWatch 警报
使用CloudWatch 警报

您可以使用 Amazon EC2 控制台创建 CloudWatch 警报，或者使用 CloudWatch 控制台提供的更多高级选项。
当该指标达到指定阈值时，CloudWatch 自动向您发送通知。
使用 CloudWatch 控制台创建警报有关示例，请参阅Amazon CloudWatch 用户指南中的创建 Amazon CloudWatch 警报。
使用 Amazon EC2 控制台创建警报

打开 Amazo ...</div></div></div><div class="recent-post-item"><div class="post_cover left_radius"><a href="/2020/09/01/aws_lambda_cloudwatch_operate_ec2/" title="Lambda + Cloud Watch定时维护EC2">     <img class="post_bg" src="/img/cover/aws.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="Lambda + Cloud Watch定时维护EC2"></a></div><div class="recent-post-info"><a class="article-title" href="/2020/09/01/aws_lambda_cloudwatch_operate_ec2/" title="Lambda + Cloud Watch定时维护EC2">Lambda + Cloud Watch定时维护EC2</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">发表于</span><time datetime="2020-08-31T22:30:16.000Z" title="发表于 2020-09-01 06:30:16">2020-09-01</time></span><span class="article-meta"><span class="article-meta__separator">|</span><i class="fas fa-inbox"></i><a class="article-meta__categories" href="/categories/AWS/">AWS</a></span><span class="article-meta tags"><span class="article-meta__separator">|</span><i class="fas fa-tag"></i><a class="article-meta__tags" href="/tags/CloudWatch/">CloudWatch</a><span class="article-meta__link">•</span><a class="article-meta__tags" href="/tags/Lambda/">Lambda</a></span></div><div class="content">
知识文档：


Lambda
Cloudwatch


有时候在EC2上的一些业务只需要在每天的某个时间段对外提供服务，其余的时候是处于闲置空转的状态。但付费方式为EC2的按需收费，那么闲置时间产生的费用就显得浪费了。怎么办呢？通过Lambda服务结合Cloudwatch规则，实现实例的定时开关，达到节约成本的目的。
业务需求：

每天上午（UTC）9:00~20:00，将实例启动使其处于running状态
每天晚上（UTC）20:00~次日上午9:00，将实例停止使其处于stopped状态。


环境需要用到的AWS服务包括：

EC2：即云端虚拟机，将用于运行我们的脚本。
Lambda, 用于操作我们的EC2实例，即启动和关闭。
IAM, AWS Identity and Access Management, 用于赋予Lambda函数操作我们EC2实例的权限。
Cloud Watch, 用于定时执行我们的Lambda函数，达到定时开关机的效果。


EC2实例的创建步骤这里就不介绍了，可以参考AWS 官方文档。
测试资源如下：



Name
实例ID



XLDSMILE-U ...</div></div></div><div class="recent-post-item"><div class="post_cover right_radius"><a href="/2020/08/26/aws_ami_1/" title="自定义创建 Amazon EBS 支持的AMI">     <img class="post_bg" src="/img/cover/aws.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="自定义创建 Amazon EBS 支持的AMI"></a></div><div class="recent-post-info"><a class="article-title" href="/2020/08/26/aws_ami_1/" title="自定义创建 Amazon EBS 支持的AMI">自定义创建 Amazon EBS 支持的AMI</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">发表于</span><time datetime="2020-08-25T22:30:16.000Z" title="发表于 2020-08-26 06:30:16">2020-08-26</time></span><span class="article-meta"><span class="article-meta__separator">|</span><i class="fas fa-inbox"></i><a class="article-meta__categories" href="/categories/AWS/">AWS</a></span><span class="article-meta tags"><span class="article-meta__separator">|</span><i class="fas fa-tag"></i><a class="article-meta__tags" href="/tags/AMI/">AMI</a></span></div><div class="content">
知识文档：


创建 Amazon EBS 支持的 Linux AMI


自定义AMI，可以让我们结合日常工作，预置好一些应用程序或配置，以缩短配置耗时。
此外，您还可以借助自定义 AMI 对底层组件 (如 Linux 内核) 进行更改，这在配置文件中很难实现或需要很长时间才能完成。
AMI 包括以下内容：

一个或多个 Amazon Elastic Block Store (Amazon EBS) 快照；对于由实例存储支持的 AMI，包括一个用于实例（例如，操作系统、应用程序服务器和应用程序）根卷的模板。
控制可以使用 AMI 启动实例的 AWS 账户的启动许可。
数据块设备映射，指定在实例启动时要附加到实例的卷。

选择适合的AMI可以基于以下特性选择要使用的 AMI：

区域 (请参阅区域和可用区)
操作系统
架构 (32 位或 64 位)
启动许可
根设备存储

AMI类型确定 AMI 的根设备类型使用控制台确定 AMI 的根设备类型：

打开 Amazon EC2 控制台。
在导航窗格中，单击 AMI，然后选择 AMI。
在 Details (详细信息) 选项卡中检查 R ...</div></div></div><nav id="pagination"><div class="pagination"><span class="page-number current">1</span><a class="page-number" href="/page/2/">2</a><span class="space">&hellip;</span><a class="page-number" href="/page/7/">7</a><a class="extend next" rel="next" href="/page/2/"><i class="fas fa-chevron-right fa-fw"></i></a></div></nav></div><div class="aside-content" id="aside-content"><div class="card-widget card-info"><div class="card-info-avatar is-center"><img class="avatar-img" src="/img/avatar.jpg" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/><div class="author-info__name">Mr.GaO</div><div class="author-info__description"></div></div><div class="card-info-data"><div class="card-info-data-item is-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">66</div></a></div><div class="card-info-data-item is-center"><a href="/tags/"><div class="headline">标签</div><div class="length-num">27</div></a></div><div class="card-info-data-item is-center"><a href="/categories/"><div class="headline">分类</div><div class="length-num">8</div></a></div></div><a class="button--animated" id="card-info-btn" target="_blank" rel="noopener" href="https://github.com/xxxxxx"><i class="fab fa-github"></i><span>Follow Me</span></a><div class="card-info-social-icons is-center"><a class="social-icon" href="mailto:xldsmile@163.com" target="_blank" title="Email"><i class="fas fa-envelope"></i></a></div></div><div class="card-widget card-announcement"><div class="item-headline"><i class="fas fa-bullhorn card-announcement-animation"></i><span>公告</span></div><div class="announcement_content">冲鸭！！!</div></div><div class="sticky_layout"><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>最新文章</span></div><div class="aside-list"><div class="aside-list-item"><a class="thumbnail" href="/2021/07/10/ansible_win_spooler_fix/" title="Windows打印机漏洞修复"><img src="/img/cover/goland.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="Windows打印机漏洞修复"/></a><div class="content"><a class="title" href="/2021/07/10/ansible_win_spooler_fix/" title="Windows打印机漏洞修复">Windows打印机漏洞修复</a><time datetime="2021-07-10T13:11:10.000Z" title="发表于 2021-07-10 21:11:10">2021-07-10</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2020/09/05/aws_s3_introduction/" title="AWS S3 Bucket 简介"><img src="/img/cover/aws.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="AWS S3 Bucket 简介"/></a><div class="content"><a class="title" href="/2020/09/05/aws_s3_introduction/" title="AWS S3 Bucket 简介">AWS S3 Bucket 简介</a><time datetime="2020-09-04T22:30:16.000Z" title="发表于 2020-09-05 06:30:16">2020-09-05</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2020/09/05/aws_s3cmd/" title="s3cmd—AWS S3存储桶管理工具"><img src="/img/cover/aws.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="s3cmd—AWS S3存储桶管理工具"/></a><div class="content"><a class="title" href="/2020/09/05/aws_s3cmd/" title="s3cmd—AWS S3存储桶管理工具">s3cmd—AWS S3存储桶管理工具</a><time datetime="2020-09-04T22:30:16.000Z" title="发表于 2020-09-05 06:30:16">2020-09-05</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2020/09/03/aws_elb_listener/" title="AWS 侦听器配置管理"><img src="/img/cover/aws.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="AWS 侦听器配置管理"/></a><div class="content"><a class="title" href="/2020/09/03/aws_elb_listener/" title="AWS 侦听器配置管理">AWS 侦听器配置管理</a><time datetime="2020-09-02T22:30:16.000Z" title="发表于 2020-09-03 06:30:16">2020-09-03</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2020/09/03/aws_elb_use/" title="AWS应用程序负载均衡的使用"><img src="/img/cover/aws.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="AWS应用程序负载均衡的使用"/></a><div class="content"><a class="title" href="/2020/09/03/aws_elb_use/" title="AWS应用程序负载均衡的使用">AWS应用程序负载均衡的使用</a><time datetime="2020-09-02T22:30:16.000Z" title="发表于 2020-09-03 06:30:16">2020-09-03</time></div></div></div></div><div class="card-widget card-categories"><div class="item-headline">
            <i class="fas fa-folder-open"></i>
            <span>分类</span>
            
            </div>
            <ul class="card-category-list" id="aside-cat-list">
            <li class="card-category-list-item "><a class="card-category-list-link" href="/categories/AWS/"><span class="card-category-list-name">AWS</span><span class="card-category-list-count">15</span></a></li><li class="card-category-list-item "><a class="card-category-list-link" href="/categories/Ansible/"><span class="card-category-list-name">Ansible</span><span class="card-category-list-count">18</span></a></li><li class="card-category-list-item "><a class="card-category-list-link" href="/categories/Go/"><span class="card-category-list-name">Go</span><span class="card-category-list-count">15</span></a></li><li class="card-category-list-item "><a class="card-category-list-link" href="/categories/Security/"><span class="card-category-list-name">Security</span><span class="card-category-list-count">1</span></a></li><li class="card-category-list-item "><a class="card-category-list-link" href="/categories/Tools/"><span class="card-category-list-name">Tools</span><span class="card-category-list-count">2</span></a></li><li class="card-category-list-item "><a class="card-category-list-link" href="/categories/%E5%90%83%E5%96%9D%E7%8E%A9%E4%B9%90/"><span class="card-category-list-name">吃喝玩乐</span><span class="card-category-list-count">3</span></a></li><li class="card-category-list-item "><a class="card-category-list-link" href="/categories/%E5%9F%BA%E7%A1%80%E8%BF%90%E7%BB%B4/"><span class="card-category-list-name">基础运维</span><span class="card-category-list-count">11</span></a></li><li class="card-category-list-item "><a class="card-category-list-link" href="/categories/%E9%98%BF%E9%87%8C%E4%BA%91/"><span class="card-category-list-name">阿里云</span><span class="card-category-list-count">1</span></a></li>
            </ul></div><div class="card-widget card-tags"><div class="item-headline"><i class="fas fa-tags"></i><span>标签</span></div><div class="card-tag-cloud"><a href="/tags/hexo/" style="font-size: 1.17em; color: rgb(109, 36, 31)">hexo</a><a href="/tags/markdown/" style="font-size: 1.17em; color: rgb(29, 33, 13)">markdown</a><a href="/tags/env/" style="font-size: 1.43em; color: rgb(37, 34, 193)">env</a><a href="/tags/oss/" style="font-size: 1.1em; color: rgb(151, 97, 114)">oss</a><a href="/tags/ansible%E5%9F%BA%E7%A1%80/" style="font-size: 1.5em; color: rgb(112, 137, 106)">ansible基础</a><a href="/tags/%E5%AE%9E%E8%B7%B5%E6%80%BB%E7%BB%93/" style="font-size: 1.37em; color: rgb(73, 119, 48)">实践总结</a><a href="/tags/playbook/" style="font-size: 1.43em; color: rgb(81, 128, 14)">playbook</a><a href="/tags/baseline/" style="font-size: 1.1em; color: rgb(149, 199, 193)">baseline</a><a href="/tags/CVE/" style="font-size: 1.1em; color: rgb(157, 124, 95)">CVE</a><a href="/tags/AMI/" style="font-size: 1.1em; color: rgb(38, 83, 143)">AMI</a><a href="/tags/EC2/" style="font-size: 1.3em; color: rgb(199, 165, 117)">EC2</a><a href="/tags/EBS/" style="font-size: 1.1em; color: rgb(42, 114, 39)">EBS</a><a href="/tags/CloudWatch/" style="font-size: 1.23em; color: rgb(137, 49, 18)">CloudWatch</a><a href="/tags/ELB/" style="font-size: 1.23em; color: rgb(39, 39, 41)">ELB</a><a href="/tags/Lambda/" style="font-size: 1.1em; color: rgb(44, 1, 198)">Lambda</a><a href="/tags/S3/" style="font-size: 1.17em; color: rgb(142, 67, 99)">S3</a><a href="/tags/go%E8%AF%AD%E8%A8%80%E5%9F%BA%E7%A1%80/" style="font-size: 1.43em; color: rgb(139, 187, 72)">go语言基础</a><a href="/tags/array/" style="font-size: 1.1em; color: rgb(95, 185, 13)">array</a><a href="/tags/%E5%90%83%E5%96%9D%E7%8E%A9%E4%B9%90/" style="font-size: 1.1em; color: rgb(39, 200, 87)">吃喝玩乐</a><a href="/tags/%E5%87%BD%E6%95%B0/" style="font-size: 1.17em; color: rgb(192, 41, 194)">函数</a><a href="/tags/map/" style="font-size: 1.1em; color: rgb(23, 37, 64)">map</a><a href="/tags/%E6%B5%81%E7%A8%8B%E6%8E%A7%E5%88%B6/" style="font-size: 1.1em; color: rgb(104, 0, 186)">流程控制</a><a href="/tags/slice/" style="font-size: 1.1em; color: rgb(179, 64, 120)">slice</a><a href="/tags/variable/" style="font-size: 1.1em; color: rgb(122, 8, 170)">variable</a><a href="/tags/%E6%95%B0%E6%8D%AE%E7%B1%BB%E5%9E%8B/" style="font-size: 1.1em; color: rgb(100, 186, 10)">数据类型</a><a href="/tags/command/" style="font-size: 1.37em; color: rgb(200, 19, 47)">command</a><a href="/tags/Linux%E5%AE%89%E8%A3%85/" style="font-size: 1.23em; color: rgb(42, 0, 24)">Linux安装</a></div></div><div class="card-widget card-archives"><div class="item-headline"><i class="fas fa-archive"></i><span>归档</span><a class="card-more-btn" href="/archives/" title="查看更多">
    <i class="fas fa-angle-right"></i></a></div><ul class="card-archive-list"><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2021/07/"><span class="card-archive-list-date">七月 2021</span><span class="card-archive-list-count">1</span></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2020/09/"><span class="card-archive-list-date">九月 2020</span><span class="card-archive-list-count">8</span></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2020/08/"><span class="card-archive-list-date">八月 2020</span><span class="card-archive-list-count">5</span></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2020/07/"><span class="card-archive-list-date">七月 2020</span><span class="card-archive-list-count">1</span></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2020/05/"><span class="card-archive-list-date">五月 2020</span><span class="card-archive-list-count">3</span></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2020/04/"><span class="card-archive-list-date">四月 2020</span><span class="card-archive-list-count">10</span></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2020/01/"><span class="card-archive-list-date">一月 2020</span><span class="card-archive-list-count">5</span></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2019/09/"><span class="card-archive-list-date">九月 2019</span><span class="card-archive-list-count">1</span></a></li></ul></div><div class="card-widget card-webinfo"><div class="item-headline"><i class="fas fa-chart-line"></i><span>网站资讯</span></div><div class="webinfo"><div class="webinfo-item"><div class="item-name">文章数目 :</div><div class="item-count">66</div></div><div class="webinfo-item"><div class="item-name">本站访客数 :</div><div class="item-count" id="busuanzi_value_site_uv"></div></div><div class="webinfo-item"><div class="item-name">本站总访问量 :</div><div class="item-count" id="busuanzi_value_site_pv"></div></div><div class="webinfo-item"><div class="item-name">最后更新时间 :</div><div class="item-count" id="last-push-date" data-lastPushDate="2024-06-27T10:15:10.307Z"></div></div></div></div></div></div></main><footer id="footer"><div id="footer-wrap"><div class="copyright">&copy;1992 - 2024 By Mr.GaO</div><div class="footer_custom_text"><a target="_blank" rel="noopener" href="http://www.beian.miit.gov.cn/">ICP号</a><img class="icp-icon" src="/img/psr.webp"><span>京ICP备 2021003300号</span></a></div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="darkmode" type="button" title="浅色和深色模式转换"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="单栏和双栏切换"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside_config" type="button" title="设置"><i class="fas fa-cog fa-spin"></i></button><button id="go-up" type="button" title="回到顶部"><i class="fas fa-arrow-up"></i></button></div></div><div id="local-search"><div class="search-dialog"><div class="search-dialog__title" id="local-search-title">本地搜索</div><div id="local-input-panel"><div id="local-search-input"><div class="local-search-box"><input class="local-search-box--input" placeholder="搜索文章" type="text"/></div></div></div><hr/><div id="local-search-results"></div><span class="search-close-button"><i class="fas fa-times"></i></span></div><div id="search-mask"></div></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="/js/search/local-search.js"></script><script>var preloader = {
  endLoading: () => {
    document.body.style.overflow = 'auto';
    document.getElementById('loading-box').classList.add("loaded")
  },
  initLoading: () => {
    document.body.style.overflow = '';
    document.getElementById('loading-box').classList.remove("loaded")

  }
}
window.addEventListener('load',preloader.endLoading())</script><div class="js-pjax"><script>function subtitleType () {
  if (true) { 
    var typed = new Typed("#subtitle", {
      strings: "Hate life is not as good as water&#44; wait for the waves to rise leisurely".split(","),
      startDelay: 300,
      typeSpeed: 150,
      loop: true,
      backSpeed: 50
    })
  } else {
    document.getElementById("subtitle").innerHTML = 'Hate life is not as good as water&#44; wait for the waves to rise leisurely'
  }
}

if (true) {
  if (typeof Typed === 'function') {
    subtitleType()
  } else {
    getScript('https://cdn.jsdelivr.net/npm/typed.js/lib/typed.min.js').then(subtitleType)
  }
} else {
  subtitleType()
}</script></div><script> let backimg =["url(/img/bg/bg3.webp)","url(/img/bg/bg5.jpg)"];let index =Math.ceil(Math.random() * (backimg.length-1));document.getElementById("web_bg").style.backgroundImage = backimg[index]</script><div class="aplayer no-destroy aplayer aplayer-tag-marker meting-tag-marker" data-id="7884240066" data-server="tencent" data-type="playlist" data-fixed="true" data-mini="true" data-listFolded="false" data-order="random" data-preload="none" data-autoplay="true" muted></div><script id="click-show-text" src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1/dist/click-show-text.min.js" data-mobile="false" data-text="GKD,Giao,404" data-fontsize="15px" data-random="false" async="async"></script><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/aplayer/dist/APlayer.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/aplayer/dist/APlayer.min.js"></script><script src="https://cdn.jsdelivr.net/gh/metowolf/MetingJS@1.2/dist/Meting.min.js"></script><script src="https://cdn.jsdelivr.net/npm/pjax/pjax.min.js"></script><script>let pjaxSelectors = [
  'title',
  '#config-diff',
  '#body-wrap',
  '#rightside-config-hide',
  '#rightside-config-show',
  '.js-pjax'
]

if (false) {
  pjaxSelectors.unshift('meta[property="og:image"]', 'meta[property="og:title"]', 'meta[property="og:url"]')
}

var pjax = new Pjax({
  elements: 'a:not([target="_blank"])',
  selectors: pjaxSelectors,
  cacheBust: false,
  analytics: false,
  scrollRestoration: false
})

document.addEventListener('pjax:complete', function () {
  window.refreshFn()

  document.querySelectorAll('script[data-pjax]').forEach(item => {
    const newScript = document.createElement('script')
    const content = item.text || item.textContent || item.innerHTML || ""
    Array.from(item.attributes).forEach(attr => newScript.setAttribute(attr.name, attr.value))
    newScript.appendChild(document.createTextNode(content))
    item.parentNode.replaceChild(newScript, item)
  })

  GLOBAL_CONFIG.islazyload && window.lazyLoadInstance.update()

  typeof chatBtnFn === 'function' && chatBtnFn()
  typeof panguInit === 'function' && panguInit()

  if (typeof gtag === 'function') {
    gtag('config', '', {'page_path': window.location.pathname});
  }

  typeof loadMeting === 'function' && document.getElementsByClassName('aplayer').length && loadMeting()

  // Analytics
  if (false) {
    MtaH5.pgv()
  }

  // prismjs
  typeof Prism === 'object' && Prism.highlightAll()

  typeof preloader === 'object' && preloader.endLoading()
})


document.addEventListener('pjax:send', function () {
  typeof preloader === 'object' && preloader.initLoading()
  
  if (window.aplayers) {
    for (let i = 0; i < window.aplayers.length; i++) {
      if (!window.aplayers[i].options.fixed) {
        window.aplayers[i].destroy()
      }
    }
  }

  typeof typed === 'object' && typed.destroy()

  //reset readmode
  const $bodyClassList = document.body.classList
  $bodyClassList.contains('read-mode') && $bodyClassList.remove('read-mode')

})

document.addEventListener('pjax:error', (e) => {
  if (e.request.status === 404) {
    pjax.loadUrl('/404.html')
  }
})</script><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script></div><script src="/live2dw/lib/L2Dwidget.min.js?094cbace49a39548bed64abff5988b05"></script><script>L2Dwidget.init({"model":{"jsonPath":"/live2dw/assets/hibiki.model.json"},"display":{"position":"right","width":150,"height":370},"mobile":{"show":false},"log":false,"pluginJsPath":"lib/","pluginModelPath":"assets/","pluginRootPath":"live2dw/","tagMode":false});</script></body></html>